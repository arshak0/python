class Stack:

   genMax = []
   genDict = {}

   def __init__(self):
     self.stack=[]
     self.dict={}
     self.max=[]

   def push(self, item):
       self.stack.append(item)
       self.UpdateDict(item)
       self.UpdateMax(item)
       self.UpdateGenDict(item)
       self.UpdateGenMax(item)

   def UpdateDict(self, item):
       if item in self.dict:
           self.dict[item]=self.dict[item]+1
       else:
           self.dict[item]=1

   def UpdateGenDict(self, item):
       if item in self.genDict:
           self.genDict[item]=self.genDict[item]+1
       else:
           self.genDict[item]=1

   def UpdateMax(self, item):
       if len(self.max)==0:
           self.max.append(item)
       elif item > self.max[-1]:
           self.max.append(item)

   def UpdateGenMax(self, item):
       if len(self.genMax)==0:
           self.genMax.append(item)
       elif item > self.genMax[-1]:
           self.genMax.append(item)

   def pop(self):
       try:
           y=self.stack[-1]
           del self.stack[-1]
           self.UpdateMaxPop(y)
           self.UpdateDictPop(y)
           self.UpdateGenMaxPop(y)
           self.UpdateGenDictPop(y)
           return y
       except:
              return "no elements in stack"

   def UpdateMaxPop(self,y):
       if y==self.max[-1] and self.dict[y]==1:
           del self.max[-1]

   def UpdateDictPop(self, y):
       if self.dict[y]>1:
           self.dict[y]=self.dict[y]-1
       else:
           del self.dict[y]

   def UpdateGenMaxPop(self,y):
       if y==self.genMax[-1] and self.genDict[y]==1:
           del self.genMax[-1]

   def UpdateGenDictPop(self, y):
       if self.genDict[y]>1:
           self.genDict[y]=self.genDict[y]-1
       else:
           del self.genDict[y]

   def getMax(self):
       return self.max[-1]

Stack1 = Stack()
Stack2 = Stack()
Stack3 = Stack()

for i in range(-4, 1):
    Stack1.push(i)
for i in range (0,9):
    Stack2.push(i)
for i in range(0, 8):
    Stack3.push(i)
Stack1.push(88)
Stack3.pop()
Stack2.pop()

print(Stack1.stack)
print(Stack1.dict)
print(Stack1.getMax())
print(Stack1.max)
print("\n")
print(Stack2.stack)
print(Stack2.dict)
print(Stack2.getMax())
print(Stack2.max)
print("\n")
print(Stack3.stack)
print(Stack3.dict)
print(Stack3.getMax())
print(Stack3.max)
print("\n")
print(Stack.genMax)
print(Stack.genDict)

